<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    body{margin:0;padding:0;font-family:Roboto,sans-serif;
         display:flex;align-items:center;justify-content:center;
         height:100vh;background:transparent}
    #timer{font-size:1.4rem;color:#1976d2}
  </style>
</head>
<body>
  <div id="timer">Chargement…</div>
  <script>
    let intv;
    google.script.run.withSuccessHandler(start).getCountdownTarget();
    function start(iso){
      const el=document.getElementById('timer');
      if(!iso){ el.textContent='Non configuré'; return }
      const tgt=new Date(iso).getTime();
      function upd(){
        const diff=tgt-Date.now();
        if(diff>0){
          const d=Math.floor(diff/86400000),
                h=Math.floor((diff%86400000)/3600000),
                m=Math.floor((diff%3600000)/60000),
                s=Math.floor((diff%60000)/1000);
          el.textContent=`${d}j ${h}h ${m}m ${s}s`;
        } else {
          clearInterval(intv);
          el.textContent='Le vote est terminé !';
          parent.postMessage({type:'timerEnded'},'*');
        }
      }
      upd(); intv=setInterval(upd,1000);
    }
  </script>
</body>
</html>
